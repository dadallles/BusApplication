@model BusApplication.Models.ViewModels.LineNameVM

@{
    ViewData["Title"] = "Dodaj linię";
    Layout = "~/Views/Shared/_Layout.cshtml";
    Model.busStopList.Add(new BusStopList());
    Model.busStopList[0].BusStopNumber = 1;

    int iter = 1;

    void RenderNext()
    {
        Model.busStopList.Add(new BusStopList());
        Model.busStopList[iter].BusStopNumber = iter + 1;

        @:<div class="form-group row">
            @:<div class="col-4">
                @:<label asp-for="busStopList[@iter].BusStopId">Przystanek nr. @(iter + 1)</label>
            @:</div>
            @:<div class="col-8">
                @Html.DropDownListFor(x => x.busStopList[iter].BusStopId, Model.BusStopListItem, new { @class = "form-control", @id = @iter, @disabled = "disabled" })
            @:</div>
        @:</div>

        iter++;
    }

}

<br />
<br />
<form method="post" asp-action="Insert" enctype="multipart/form-data">
    <div class="row backgroundWhite border">
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
        <div class="col-12">
            <h2 class="text-primary">Dodaj nową linię</h2>
            <br />
        </div>
        <div class="col-8">
            <div class="form-group row">
                <div class="col-4">
                    <label asp-for="lineName.Name"></label>
                </div>
                <div class="col-8">
                    <input asp-for="lineName.Name" class="form-control" id="name" />
                    <span asp-validation-for="lineName.Name" class="text-danger"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-4">
                    <label asp-for="IsReversedToo"></label>
                </div>
                <div class="col-8">
                    <input asp-for="IsReversedToo" class="form-control" id="isReversed" onclick="revFun()" />
                    <span asp-validation-for="IsReversedToo" class="text-danger"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-4">
                    <label asp-for="ReversedLineName"></label>
                </div>
                <div class="col-8">
                    <input asp-for="ReversedLineName" class="form-control" id="reversedName" disabled />
                    <span asp-validation-for="ReversedLineName" class="text-danger"></span>
                </div>
            </div>
            <br />
            <div class="form-group row">
                <div class="col-4">
                    <label asp-for="busStopList[0].BusStopId">Przystanek nr. 1</label>
                </div>
                <div class="col-8">
                    @Html.DropDownListFor(x => x.busStopList[0].BusStopId, Model.BusStopListItem, new { @class = "form-control", @id = 0 })
                </div>
            </div>

            @{ if (Model.NumberOfBusStops > 50)
                {
                    for (int i = 1; i < 50; ++i)
                    {
                        RenderNext();
                    }
                }
                else
                {
                    for (int i = 1; i < Model.NumberOfBusStops; ++i)
                    {
                        RenderNext();
                    }
                } }

            <div class="row">
                <div class="col">
                    <button type="submit" onclick="return validateInput()" class="btn btn-primary form-control">Dodaj</button>
                </div>
                <div class="col">
                    <a asp-action="Index" class="btn btn-success form-control">Wróć do listy</a>
                </div>
            </div>
        </div>
    </div>
</form>

@section Scripts{
    <script src="https://cdn.tiny.cloud/1/n94ifuzvl80pchikopiwgz2esrw8n28dwcywvpejlqrregfp/tinymce/5/tinymce.min.js"></script>
    <script>

        $("#0").on("click", function () {
            if ($('#0').val() != 1) {
                $('#1').prop('disabled', false);
            }
        });
        $("#1").on("click", function () {
            if ($('#1').val() != 1) {
                $('#2').prop('disabled', false);
            }
        });
        $("#2").on("click", function () {
            if ($('#2').val() != 1) {
                $('#3').prop('disabled', false);
            }
        });
        $("#3").on("click", function () {
            if ($('#3').val() != 1) {
                $('#4').prop('disabled', false);
            }
        });
        $("#4").on("click", function () {
            if ($('#4').val() != 1) {
                $('#5').prop('disabled', false);
            }
        });
        $("#5").on("click", function () {
            if ($('#5').val() != 1) {
                $('#6').prop('disabled', false);
            }
        });
        $("#6").on("click", function () {
            if ($('#6').val() != 1) {
                $('#7').prop('disabled', false);
            }
        });
        $("#7").on("click", function () {
            if ($('#7').val() != 1) {
                $('#8').prop('disabled', false);
            }
        });
        $("#8").on("click", function () {
            if ($('#8').val() != 1) {
                $('#9').prop('disabled', false);
            }
        });
        $("#9").on("click", function () {
            if ($('#9').val() != 1) {
                $('#10').prop('disabled', false);
            }
        });
        $("#10").on("click", function () {
            if ($('#10').val() != 1) {
                $('#11').prop('disabled', false);
            }
        });
        $("#11").on("click", function () {
            if ($('#11').val() != 1) {
                $('#12').prop('disabled', false);
            }
        });
        $("#12").on("click", function () {
            if ($('#12').val() != 1) {
                $('#13').prop('disabled', false);
            }
        });
        $("#13").on("click", function () {
            if ($('#13').val() != 1) {
                $('#14').prop('disabled', false);
            }
        });
        $("#14").on("click", function () {
            if ($('#14').val() != 1) {
                $('#15').prop('disabled', false);
            }
        });
        $("#15").on("click", function () {
            if ($('#15').val() != 1) {
                $('#16').prop('disabled', false);
            }
        });
        $("#16").on("click", function () {
            if ($('#16').val() != 1) {
                $('#17').prop('disabled', false);
            }
        });
        $("#17").on("click", function () {
            if ($('#17').val() != 1) {
                $('#18').prop('disabled', false);
            }
        });
        $("#18").on("click", function () {
            if ($('#18').val() != 1) {
                $('#19').prop('disabled', false);
            }
        });
        $("#19").on("click", function () {
            if ($('#19').val() != 1) {
                $('#20').prop('disabled', false);
            }
        });
        $("#20").on("click", function () {
            if ($('#20').val() != 1) {
                $('#21').prop('disabled', false);
            }
        });
        $("#21").on("click", function () {
            if ($('#21').val() != 1) {
                $('#22').prop('disabled', false);
            }
        });
        $("#22").on("click", function () {
            if ($('#22').val() != 1) {
                $('#23').prop('disabled', false);
            }
        });
        $("#23").on("click", function () {
            if ($('#23').val() != 1) {
                $('#24').prop('disabled', false);
            }
        });
        $("#24").on("click", function () {
            if ($('#24').val() != 1) {
                $('#25').prop('disabled', false);
            }
        });
        $("#25").on("click", function () {
            if ($('#25').val() != 1) {
                $('#26').prop('disabled', false);
            }
        });
        $("#26").on("click", function () {
            if ($('#26').val() != 1) {
                $('#27').prop('disabled', false);
            }
        });
        $("#27").on("click", function () {
            if ($('#27').val() != 1) {
                $('#28').prop('disabled', false);
            }
        });
        $("#28").on("click", function () {
            if ($('#28').val() != 1) {
                $('#29').prop('disabled', false);
            }
        });
        $("#29").on("click", function () {
            if ($('#29').val() != 1) {
                $('#30').prop('disabled', false);
            }
        });
        $("#30").on("click", function () {
            if ($('#30').val() != 1) {
                $('#31').prop('disabled', false);
            }
        });
        $("#31").on("click", function () {
            if ($('#31').val() != 1) {
                $('#32').prop('disabled', false);
            }
        });
        $("#32").on("click", function () {
            if ($('#32').val() != 1) {
                $('#33').prop('disabled', false);
            }
        });
        $("#33").on("click", function () {
            if ($('#33').val() != 1) {
                $('#34').prop('disabled', false);
            }
        });
        $("#34").on("click", function () {
            if ($('#34').val() != 1) {
                $('#35').prop('disabled', false);
            }
        });
        $("#35").on("click", function () {
            if ($('#35').val() != 1) {
                $('#36').prop('disabled', false);
            }
        });
        $("#36").on("click", function () {
            if ($('#36').val() != 1) {
                $('#37').prop('disabled', false);
            }
        });
        $("#37").on("click", function () {
            if ($('#37').val() != 1) {
                $('#38').prop('disabled', false);
            }
        });
        $("#38").on("click", function () {
            if ($('#38').val() != 1) {
                $('#39').prop('disabled', false);
            }
        });
        $("#39").on("click", function () {
            if ($('#39').val() != 1) {
                $('#40').prop('disabled', false);
            }
        });
        $("#40").on("click", function () {
            if ($('#40').val() != 1) {
                $('#41').prop('disabled', false);
            }
        });
        $("#41").on("click", function () {
            if ($('#41').val() != 1) {
                $('#42').prop('disabled', false);
            }
        });
        $("#42").on("click", function () {
            if ($('#42').val() != 1) {
                $('#43').prop('disabled', false);
            }
        });
        $("#43").on("click", function () {
            if ($('#43').val() != 1) {
                $('#44').prop('disabled', false);
            }
        });
        $("#44").on("click", function () {
            if ($('#44').val() != 1) {
                $('#45').prop('disabled', false);
            }
        });
        $("#45").on("click", function () {
            if ($('#45').val() != 1) {
                $('#46').prop('disabled', false);
            }
        });
        $("#46").on("click", function () {
            if ($('#46').val() != 1) {
                $('#47').prop('disabled', false);
            }
        });
        $("#47").on("click", function () {
            if ($('#47').val() != 1) {
                $('#48').prop('disabled', false);
            }
        });
        $("#48").on("click", function () {
            if ($('#48').val() != 1) {
                $('#49').prop('disabled', false);
            }
        });
        $("#49").on("click", function () {
            if ($('#49').val() != 1) {
                $('#50').prop('disabled', false);
            }
        });

        function revFun() {
            if ($("#reversedName").is('[disabled=disabled]') == false) {
                $("#reversedName").prop("disabled", false);
            }
            else {
                $("#reversedName").prop("disabled", true);
            }
        }

        function validateInput() {
            for (var i = 0; i < 30; i++) {
                if (document.getElementById(i).value == 1) {
                    swal("Błąd", "Należy wybrać co najmniej 3 przystanki, żaden z przystanków nie może być oznaczony jako 'Brak'", "error")
                    return false;
                }
            }

            if (document.getElementById("name").value == "") {
                swal("Błąd", "Należy wpisać nazwę linii!", "error")
                return false;
            }

            if (document.getElementById("isReversed") == true && document.getElementById("reversedName").value == "") {
                swal("Błąd", "Należy wpisać nazwę linii powrotnej!", "error")
                return false;
            }

            return true;
        };
    </script>
}
